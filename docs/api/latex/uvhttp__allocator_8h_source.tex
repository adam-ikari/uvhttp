\hypertarget{uvhttp__allocator_8h_source}{}\doxysection{uvhttp\+\_\+allocator.\+h}
\label{uvhttp__allocator_8h_source}\index{include/uvhttp\_allocator.h@{include/uvhttp\_allocator.h}}
\mbox{\hyperlink{uvhttp__allocator_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 }
\DoxyCodeLine{13 \textcolor{preprocessor}{\#ifndef UVHTTP\_ALLOCATOR\_H}}
\DoxyCodeLine{14 \textcolor{preprocessor}{\#define UVHTTP\_ALLOCATOR\_H}}
\DoxyCodeLine{15 }
\DoxyCodeLine{16 \textcolor{preprocessor}{\#include <stddef.h>}}
\DoxyCodeLine{17 \textcolor{preprocessor}{\#include <stdlib.h>}}
\DoxyCodeLine{18 }
\DoxyCodeLine{19 \textcolor{preprocessor}{\#ifdef \_\_cplusplus}}
\DoxyCodeLine{20 \textcolor{keyword}{extern} \textcolor{stringliteral}{"{}C"{}} \{}
\DoxyCodeLine{21 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{22 }
\DoxyCodeLine{23 \textcolor{comment}{/* 编译期选择分配器类型 */}}
\DoxyCodeLine{24 \textcolor{preprocessor}{\#ifndef UVHTTP\_ALLOCATOR\_TYPE}}
\DoxyCodeLine{25 \textcolor{preprocessor}{\#    define UVHTTP\_ALLOCATOR\_TYPE 0 }\textcolor{comment}{/* 0=system, 1=mimalloc */}\textcolor{preprocessor}{}}
\DoxyCodeLine{26 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{27 }
\DoxyCodeLine{28 \textcolor{comment}{/* ========== 编译期分配器选择 ========== */}}
\DoxyCodeLine{29 }
\DoxyCodeLine{30 \textcolor{preprocessor}{\#if UVHTTP\_ALLOCATOR\_TYPE == 1 }\textcolor{comment}{/* mimalloc */}\textcolor{preprocessor}{}}
\DoxyCodeLine{31 \textcolor{preprocessor}{\#    ifdef UVHTTP\_ENABLE\_MIMALLOC}}
\DoxyCodeLine{32 \textcolor{preprocessor}{\#        include "{}mimalloc.h"{}}}
\DoxyCodeLine{33 }
\DoxyCodeLine{43 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void}* uvhttp\_alloc(\textcolor{keywordtype}{size\_t} size) \{}
\DoxyCodeLine{44     \textcolor{keywordflow}{return} mi\_malloc(size);}
\DoxyCodeLine{45 \}}
\DoxyCodeLine{46 }
\DoxyCodeLine{55 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} uvhttp\_free(\textcolor{keywordtype}{void}* ptr) \{}
\DoxyCodeLine{56     mi\_free(ptr);}
\DoxyCodeLine{57 \}}
\DoxyCodeLine{58 }
\DoxyCodeLine{69 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void}* uvhttp\_realloc(\textcolor{keywordtype}{void}* ptr, \textcolor{keywordtype}{size\_t} size) \{}
\DoxyCodeLine{70     \textcolor{keywordflow}{return} mi\_realloc(ptr, size);}
\DoxyCodeLine{71 \}}
\DoxyCodeLine{72 }
\DoxyCodeLine{83 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void}* uvhttp\_calloc(\textcolor{keywordtype}{size\_t} nmemb, \textcolor{keywordtype}{size\_t} size) \{}
\DoxyCodeLine{84     \textcolor{keywordflow}{return} mi\_calloc(nmemb, size);}
\DoxyCodeLine{85 \}}
\DoxyCodeLine{86 \textcolor{preprocessor}{\#    else}}
\DoxyCodeLine{87 \textcolor{comment}{/* mimalloc 不可用，回退到系统分配器 */}}
\DoxyCodeLine{88 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void}* uvhttp\_alloc(\textcolor{keywordtype}{size\_t} size) \{}
\DoxyCodeLine{89     \textcolor{keywordflow}{return} malloc(size);}
\DoxyCodeLine{90 \}}
\DoxyCodeLine{91 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} uvhttp\_free(\textcolor{keywordtype}{void}* ptr) \{}
\DoxyCodeLine{92     free(ptr);}
\DoxyCodeLine{93 \}}
\DoxyCodeLine{94 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void}* uvhttp\_realloc(\textcolor{keywordtype}{void}* ptr, \textcolor{keywordtype}{size\_t} size) \{}
\DoxyCodeLine{95     \textcolor{keywordflow}{return} realloc(ptr, size);}
\DoxyCodeLine{96 \}}
\DoxyCodeLine{97 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void}* uvhttp\_calloc(\textcolor{keywordtype}{size\_t} nmemb, \textcolor{keywordtype}{size\_t} size) \{}
\DoxyCodeLine{98     \textcolor{keywordflow}{return} calloc(nmemb, size);}
\DoxyCodeLine{99 \}}
\DoxyCodeLine{100 \textcolor{preprocessor}{\#    endif}}
\DoxyCodeLine{101 }
\DoxyCodeLine{102 \textcolor{preprocessor}{\#else }\textcolor{comment}{/* 系统分配器（默认） */}\textcolor{preprocessor}{}}
\DoxyCodeLine{103 \textcolor{comment}{/* 系统分配器模式 -\/ 使用内联函数确保可以用作函数指针 */}}
\DoxyCodeLine{104 }
\DoxyCodeLine{114 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void}* uvhttp\_alloc(\textcolor{keywordtype}{size\_t} size) \{}
\DoxyCodeLine{115     \textcolor{keywordflow}{return} malloc(size);}
\DoxyCodeLine{116 \}}
\DoxyCodeLine{117 }
\DoxyCodeLine{126 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} uvhttp\_free(\textcolor{keywordtype}{void}* ptr) \{}
\DoxyCodeLine{127     free(ptr);}
\DoxyCodeLine{128 \}}
\DoxyCodeLine{129 }
\DoxyCodeLine{140 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void}* uvhttp\_realloc(\textcolor{keywordtype}{void}* ptr, \textcolor{keywordtype}{size\_t} size) \{}
\DoxyCodeLine{141     \textcolor{keywordflow}{return} realloc(ptr, size);}
\DoxyCodeLine{142 \}}
\DoxyCodeLine{143 }
\DoxyCodeLine{154 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void}* uvhttp\_calloc(\textcolor{keywordtype}{size\_t} nmemb, \textcolor{keywordtype}{size\_t} size) \{}
\DoxyCodeLine{155     \textcolor{keywordflow}{return} calloc(nmemb, size);}
\DoxyCodeLine{156 \}}
\DoxyCodeLine{157 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{158 }
\DoxyCodeLine{159 \textcolor{comment}{/* ========== 分配器信息 ========== */}}
\DoxyCodeLine{160 }
\DoxyCodeLine{169 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keyword}{const} \textcolor{keywordtype}{char}* uvhttp\_allocator\_name(\textcolor{keywordtype}{void}) \{}
\DoxyCodeLine{170 \textcolor{preprocessor}{\#if UVHTTP\_ALLOCATOR\_TYPE == 1}}
\DoxyCodeLine{171 \textcolor{preprocessor}{\#    ifdef UVHTTP\_ENABLE\_MIMALLOC}}
\DoxyCodeLine{172     \textcolor{keywordflow}{return} \textcolor{stringliteral}{"{}mimalloc"{}};}
\DoxyCodeLine{173 \textcolor{preprocessor}{\#    else}}
\DoxyCodeLine{174     \textcolor{keywordflow}{return} \textcolor{stringliteral}{"{}system (mimalloc not available)"{}};}
\DoxyCodeLine{175 \textcolor{preprocessor}{\#    endif}}
\DoxyCodeLine{176 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{177     \textcolor{keywordflow}{return} \textcolor{stringliteral}{"{}system"{}};}
\DoxyCodeLine{178 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{179 \}}
\DoxyCodeLine{180 }
\DoxyCodeLine{181 \textcolor{comment}{/* ========== 使用说明 ========== */}}
\DoxyCodeLine{182 }
\DoxyCodeLine{224 \textcolor{preprocessor}{\#ifdef \_\_cplusplus}}
\DoxyCodeLine{225 \}}
\DoxyCodeLine{226 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{227 }
\DoxyCodeLine{228 \textcolor{preprocessor}{\#endif }\textcolor{comment}{/* UVHTTP\_ALLOCATOR\_H */}\textcolor{preprocessor}{}}

\end{DoxyCode}
