\hypertarget{uvhttp__validation_8h_source}{}\doxysection{uvhttp\+\_\+validation.\+h}
\label{uvhttp__validation_8h_source}\index{include/uvhttp\_validation.h@{include/uvhttp\_validation.h}}
\mbox{\hyperlink{uvhttp__validation_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 }
\DoxyCodeLine{13 \textcolor{preprocessor}{\#ifndef UVHTTP\_VALIDATION\_H}}
\DoxyCodeLine{14 \textcolor{preprocessor}{\#define UVHTTP\_VALIDATION\_H}}
\DoxyCodeLine{15 }
\DoxyCodeLine{16 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{uvhttp__constants_8h}{uvhttp\_constants.h}}"{}}}
\DoxyCodeLine{17 }
\DoxyCodeLine{18 \textcolor{preprocessor}{\#include <ctype.h>}}
\DoxyCodeLine{19 \textcolor{preprocessor}{\#include <stddef.h>}}
\DoxyCodeLine{20 \textcolor{preprocessor}{\#include <string.h>}}
\DoxyCodeLine{21 }
\DoxyCodeLine{22 \textcolor{preprocessor}{\#ifdef \_\_cplusplus}}
\DoxyCodeLine{23 \textcolor{keyword}{extern} \textcolor{stringliteral}{"{}C"{}} \{}
\DoxyCodeLine{24 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{25 }
\DoxyCodeLine{26 \textcolor{comment}{/* 危险字符常量 */}}
\DoxyCodeLine{27 \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{char} dangerous\_path\_chars[] = \{\textcolor{charliteral}{'<'}, \textcolor{charliteral}{'>'}, \textcolor{charliteral}{':'},  \textcolor{charliteral}{'"{}'}, \textcolor{charliteral}{'|'},}
\DoxyCodeLine{28                                             \textcolor{charliteral}{'?'}, \textcolor{charliteral}{'*'}, \textcolor{charliteral}{'\(\backslash\)n'}, \textcolor{charliteral}{'\(\backslash\)r'}\};}
\DoxyCodeLine{29 \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{char} dangerous\_query\_chars[] = \{\textcolor{charliteral}{'<'}, \textcolor{charliteral}{'>'}, \textcolor{charliteral}{'"{}'}, \textcolor{charliteral}{'\(\backslash\)''}, \textcolor{charliteral}{'\(\backslash\)n'}, \textcolor{charliteral}{'\(\backslash\)r'}\};}
\DoxyCodeLine{30 \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{char} dangerous\_header\_chars[] = \{\textcolor{charliteral}{'\(\backslash\)n'}, \textcolor{charliteral}{'\(\backslash\)r'}\};}
\DoxyCodeLine{31 }
\DoxyCodeLine{32 \textcolor{comment}{/* ========== 内联验证函数 ========== */}}
\DoxyCodeLine{33 }
\DoxyCodeLine{45 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{int} uvhttp\_validate\_string\_length(\textcolor{keyword}{const} \textcolor{keywordtype}{char}* str, \textcolor{keywordtype}{size\_t} min\_len,}
\DoxyCodeLine{46                                                 \textcolor{keywordtype}{size\_t} max\_len) \{}
\DoxyCodeLine{47     \textcolor{keywordflow}{if} (!str)}
\DoxyCodeLine{48         \textcolor{keywordflow}{return} FALSE;}
\DoxyCodeLine{49     \textcolor{keywordtype}{size\_t} len = strlen(str);}
\DoxyCodeLine{50     \textcolor{keywordflow}{return} (len >= min\_len \&\& len <= max\_len) ? TRUE : FALSE;}
\DoxyCodeLine{51 \}}
\DoxyCodeLine{52 }
\DoxyCodeLine{63 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{int} uvhttp\_validate\_url\_path(\textcolor{keyword}{const} \textcolor{keywordtype}{char}* path) \{}
\DoxyCodeLine{64     \textcolor{keywordflow}{if} (!path)}
\DoxyCodeLine{65         \textcolor{keywordflow}{return} FALSE;}
\DoxyCodeLine{66     \textcolor{keywordflow}{if} (!uvhttp\_validate\_string\_length(path, 1, UVHTTP\_MAX\_PATH\_SIZE))}
\DoxyCodeLine{67         \textcolor{keywordflow}{return} FALSE;}
\DoxyCodeLine{68     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0; i < \textcolor{keyword}{sizeof}(dangerous\_path\_chars); i++) \{}
\DoxyCodeLine{69         \textcolor{keywordflow}{if} (strchr(path, dangerous\_path\_chars[i]))}
\DoxyCodeLine{70             \textcolor{keywordflow}{return} FALSE;}
\DoxyCodeLine{71     \}}
\DoxyCodeLine{72     \textcolor{keywordflow}{return} TRUE;}
\DoxyCodeLine{73 \}}
\DoxyCodeLine{74 }
\DoxyCodeLine{85 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{int} uvhttp\_validate\_header\_name(\textcolor{keyword}{const} \textcolor{keywordtype}{char}* name) \{}
\DoxyCodeLine{86     \textcolor{keywordflow}{if} (!name)}
\DoxyCodeLine{87         \textcolor{keywordflow}{return} FALSE;}
\DoxyCodeLine{88     \textcolor{keywordflow}{if} (!uvhttp\_validate\_string\_length(name, 1, \mbox{\hyperlink{uvhttp__constants_8h_a33307a1eb0edd0b816b2d4e7d0fb3200}{UVHTTP\_MAX\_HEADER\_NAME\_SIZE}}))}
\DoxyCodeLine{89         \textcolor{keywordflow}{return} FALSE;}
\DoxyCodeLine{90     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0; i < strlen(name); i++) \{}
\DoxyCodeLine{91         \textcolor{keywordtype}{char} c = name[i];}
\DoxyCodeLine{92         \textcolor{keywordflow}{if} (!isalnum(c) \&\& c != \textcolor{charliteral}{'-\/'})}
\DoxyCodeLine{93             \textcolor{keywordflow}{return} FALSE;}
\DoxyCodeLine{94     \}}
\DoxyCodeLine{95     \textcolor{keywordflow}{return} TRUE;}
\DoxyCodeLine{96 \}}
\DoxyCodeLine{97 }
\DoxyCodeLine{108 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{int} uvhttp\_validate\_header\_value\_safe(\textcolor{keyword}{const} \textcolor{keywordtype}{char}* value) \{}
\DoxyCodeLine{109     \textcolor{keywordflow}{if} (!value)}
\DoxyCodeLine{110         \textcolor{keywordflow}{return} FALSE;}
\DoxyCodeLine{111     \textcolor{keywordflow}{if} (!uvhttp\_validate\_string\_length(value, 0, UVHTTP\_MAX\_HEADER\_VALUE\_SIZE))}
\DoxyCodeLine{112         \textcolor{keywordflow}{return} FALSE;}
\DoxyCodeLine{113     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0; i < \textcolor{keyword}{sizeof}(dangerous\_header\_chars); i++) \{}
\DoxyCodeLine{114         \textcolor{keywordflow}{if} (strchr(value, dangerous\_header\_chars[i]))}
\DoxyCodeLine{115             \textcolor{keywordflow}{return} FALSE;}
\DoxyCodeLine{116     \}}
\DoxyCodeLine{117     \textcolor{keywordflow}{return} TRUE;}
\DoxyCodeLine{118 \}}
\DoxyCodeLine{119 }
\DoxyCodeLine{130 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{int} uvhttp\_validate\_query\_string(\textcolor{keyword}{const} \textcolor{keywordtype}{char}* query) \{}
\DoxyCodeLine{131     \textcolor{keywordflow}{if} (!query)}
\DoxyCodeLine{132         \textcolor{keywordflow}{return} TRUE;}
\DoxyCodeLine{133     \textcolor{keywordflow}{if} (!uvhttp\_validate\_string\_length(query, 0, \mbox{\hyperlink{uvhttp__constants_8h_ace65ddf32c04a358fe6c875aeb2532aa}{UVHTTP\_MAX\_URL\_SIZE}}))}
\DoxyCodeLine{134         \textcolor{keywordflow}{return} FALSE;}
\DoxyCodeLine{135     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0; i < \textcolor{keyword}{sizeof}(dangerous\_query\_chars); i++) \{}
\DoxyCodeLine{136         \textcolor{keywordflow}{if} (strchr(query, dangerous\_query\_chars[i]))}
\DoxyCodeLine{137             \textcolor{keywordflow}{return} FALSE;}
\DoxyCodeLine{138     \}}
\DoxyCodeLine{139     \textcolor{keywordflow}{return} TRUE;}
\DoxyCodeLine{140 \}}
\DoxyCodeLine{141 }
\DoxyCodeLine{142 \textcolor{preprocessor}{\#ifdef \_\_cplusplus}}
\DoxyCodeLine{143 \}}
\DoxyCodeLine{144 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{145 }
\DoxyCodeLine{146 \textcolor{preprocessor}{\#endif }\textcolor{comment}{/* UVHTTP\_VALIDATION\_H */}\textcolor{preprocessor}{}}

\end{DoxyCode}
