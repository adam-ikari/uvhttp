.TH "include/uvhttp_tls.h" 3 "Fri Jan 23 2026" "Version 2.0.0" "UVHTTP" \" -*- nroff -*-
.ad l
.nh
.SH NAME
include/uvhttp_tls.h
.SH SYNOPSIS
.br
.PP
\fC#include <uv\&.h>\fP
.br
\fC#include <mbedtls/ssl\&.h>\fP
.br
\fC#include <mbedtls/entropy\&.h>\fP
.br
\fC#include <mbedtls/ctr_drbg\&.h>\fP
.br
\fC#include <mbedtls/x509\&.h>\fP
.br
\fC#include <mbedtls/x509_crt\&.h>\fP
.br
\fC#include <mbedtls/ssl_cache\&.h>\fP
.br
\fC#include <mbedtls/error\&.h>\fP
.br
\fC#include <mbedtls/debug\&.h>\fP
.br
\fC#include <mbedtls/timing\&.h>\fP
.br

.SS "Classes"

.in +1c
.ti -1c
.RI "struct \fBuvhttp_tls_stats\fP"
.br
.in -1c
.SS "Typedefs"

.in +1c
.ti -1c
.RI "typedef struct \fBuvhttp_context\fP \fBuvhttp_context_t\fP"
.br
.ti -1c
.RI "typedef struct \fBuvhttp_tls_context\fP \fBuvhttp_tls_context_t\fP"
.br
.ti -1c
.RI "typedef struct \fBuvhttp_tls_stats\fP \fBuvhttp_tls_stats_t\fP"
.br
.in -1c
.SS "Enumerations"

.in +1c
.ti -1c
.RI "enum \fBuvhttp_tls_error_t\fP { \fBUVHTTP_TLS_OK\fP = 0, \fBUVHTTP_TLS_ERROR_INIT\fP = -1, \fBUVHTTP_TLS_ERROR_CERT\fP = -2, \fBUVHTTP_TLS_ERROR_KEY\fP = -3, \fBUVHTTP_TLS_ERROR_CA\fP = -4, \fBUVHTTP_TLS_ERROR_VERIFY\fP = -5, \fBUVHTTP_TLS_ERROR_HANDSHAKE\fP = -6, \fBUVHTTP_TLS_ERROR_READ\fP = -7, \fBUVHTTP_TLS_ERROR_WRITE\fP = -8, \fBUVHTTP_TLS_ERROR_INVALID_PARAM\fP = -9, \fBUVHTTP_TLS_ERROR_MEMORY\fP = -10, \fBUVHTTP_TLS_ERROR_NOT_IMPLEMENTED\fP = -11, \fBUVHTTP_TLS_ERROR_PARSE\fP = -12, \fBUVHTTP_TLS_ERROR_NO_CERT\fP = -13, \fBUVHTTP_TLS_ERROR_WANT_READ\fP = 1, \fBUVHTTP_TLS_ERROR_WANT_WRITE\fP = 2 }"
.br
.in -1c
.SS "Functions"

.in +1c
.ti -1c
.RI "\fBuvhttp_tls_error_t\fP \fBuvhttp_tls_init\fP (\fBuvhttp_context_t\fP *context)"
.br
.ti -1c
.RI "void \fBuvhttp_tls_cleanup\fP (\fBuvhttp_context_t\fP *context)"
.br
.ti -1c
.RI "\fBuvhttp_tls_context_t\fP * \fBuvhttp_tls_context_new\fP (void)"
.br
.ti -1c
.RI "void \fBuvhttp_tls_context_free\fP (\fBuvhttp_tls_context_t\fP *ctx)"
.br
.ti -1c
.RI "\fBuvhttp_tls_error_t\fP \fBuvhttp_tls_context_load_cert_chain\fP (\fBuvhttp_tls_context_t\fP *ctx, const char *cert_file)"
.br
.ti -1c
.RI "\fBuvhttp_tls_error_t\fP \fBuvhttp_tls_context_load_private_key\fP (\fBuvhttp_tls_context_t\fP *ctx, const char *key_file)"
.br
.ti -1c
.RI "\fBuvhttp_tls_error_t\fP \fBuvhttp_tls_context_load_ca_file\fP (\fBuvhttp_tls_context_t\fP *ctx, const char *ca_file)"
.br
.ti -1c
.RI "\fBuvhttp_tls_error_t\fP \fBuvhttp_tls_context_enable_client_auth\fP (\fBuvhttp_tls_context_t\fP *ctx, int require_cert)"
.br
.ti -1c
.RI "\fBuvhttp_tls_error_t\fP \fBuvhttp_tls_context_set_verify_depth\fP (\fBuvhttp_tls_context_t\fP *ctx, int depth)"
.br
.ti -1c
.RI "\fBuvhttp_tls_error_t\fP \fBuvhttp_tls_context_set_cipher_suites\fP (\fBuvhttp_tls_context_t\fP *ctx, const int *cipher_suites)"
.br
.ti -1c
.RI "\fBuvhttp_tls_error_t\fP \fBuvhttp_tls_context_enable_session_tickets\fP (\fBuvhttp_tls_context_t\fP *ctx, int enable)"
.br
.ti -1c
.RI "\fBuvhttp_tls_error_t\fP \fBuvhttp_tls_context_set_session_cache\fP (\fBuvhttp_tls_context_t\fP *ctx, int max_sessions)"
.br
.ti -1c
.RI "\fBuvhttp_tls_error_t\fP \fBuvhttp_tls_context_enable_ocsp_stapling\fP (\fBuvhttp_tls_context_t\fP *ctx, int enable)"
.br
.ti -1c
.RI "\fBuvhttp_tls_error_t\fP \fBuvhttp_tls_context_set_dh_parameters\fP (\fBuvhttp_tls_context_t\fP *ctx, const char *dh_file)"
.br
.ti -1c
.RI "mbedtls_ssl_context * \fBuvhttp_tls_create_ssl\fP (\fBuvhttp_tls_context_t\fP *ctx)"
.br
.ti -1c
.RI "\fBuvhttp_tls_error_t\fP \fBuvhttp_tls_setup_ssl\fP (mbedtls_ssl_context *ssl, int fd)"
.br
.ti -1c
.RI "\fBuvhttp_tls_error_t\fP \fBuvhttp_tls_handshake\fP (mbedtls_ssl_context *ssl)"
.br
.ti -1c
.RI "\fBuvhttp_tls_error_t\fP \fBuvhttp_tls_read\fP (mbedtls_ssl_context *ssl, void *buf, size_t len)"
.br
.ti -1c
.RI "\fBuvhttp_tls_error_t\fP \fBuvhttp_tls_write\fP (mbedtls_ssl_context *ssl, const void *buf, size_t len)"
.br
.ti -1c
.RI "int \fBuvhttp_tls_verify_peer_cert\fP (mbedtls_ssl_context *ssl)"
.br
.ti -1c
.RI "int \fBuvhttp_tls_verify_hostname\fP (mbedtls_x509_crt *cert, const char *hostname)"
.br
.ti -1c
.RI "int \fBuvhttp_tls_check_cert_validity\fP (mbedtls_x509_crt *cert)"
.br
.ti -1c
.RI "mbedtls_x509_crt * \fBuvhttp_tls_get_peer_cert\fP (mbedtls_ssl_context *ssl)"
.br
.ti -1c
.RI "int \fBuvhttp_tls_get_cert_subject\fP (mbedtls_x509_crt *cert, char *buf, size_t buf_size)"
.br
.ti -1c
.RI "int \fBuvhttp_tls_get_cert_issuer\fP (mbedtls_x509_crt *cert, char *buf, size_t buf_size)"
.br
.ti -1c
.RI "int \fBuvhttp_tls_get_cert_serial\fP (mbedtls_x509_crt *cert, char *buf, size_t buf_size)"
.br
.ti -1c
.RI "\fBuvhttp_tls_error_t\fP \fBuvhttp_tls_context_enable_crl_checking\fP (\fBuvhttp_tls_context_t\fP *ctx, int enable)"
.br
.ti -1c
.RI "\fBuvhttp_tls_error_t\fP \fBuvhttp_tls_load_crl_file\fP (\fBuvhttp_tls_context_t\fP *ctx, const char *crl_file)"
.br
.ti -1c
.RI "\fBuvhttp_tls_error_t\fP \fBuvhttp_tls_get_ocsp_response\fP (mbedtls_ssl_context *ssl, unsigned char **ocsp_response, size_t *response_len)"
.br
.ti -1c
.RI "\fBuvhttp_tls_error_t\fP \fBuvhttp_tls_verify_ocsp_response\fP (mbedtls_x509_crt *cert, const unsigned char *ocsp_response, size_t response_len)"
.br
.ti -1c
.RI "\fBuvhttp_tls_error_t\fP \fBuvhttp_tls_context_enable_tls13\fP (\fBuvhttp_tls_context_t\fP *ctx, int enable)"
.br
.ti -1c
.RI "\fBuvhttp_tls_error_t\fP \fBuvhttp_tls_context_set_tls13_cipher_suites\fP (\fBuvhttp_tls_context_t\fP *ctx, const char *cipher_suites)"
.br
.ti -1c
.RI "\fBuvhttp_tls_error_t\fP \fBuvhttp_tls_context_enable_early_data\fP (\fBuvhttp_tls_context_t\fP *ctx, int enable)"
.br
.ti -1c
.RI "\fBuvhttp_tls_error_t\fP \fBuvhttp_tls_context_set_ticket_key\fP (\fBuvhttp_tls_context_t\fP *ctx, const unsigned char *key, size_t key_len)"
.br
.ti -1c
.RI "\fBuvhttp_tls_error_t\fP \fBuvhttp_tls_context_rotate_ticket_key\fP (\fBuvhttp_tls_context_t\fP *ctx)"
.br
.ti -1c
.RI "\fBuvhttp_tls_error_t\fP \fBuvhttp_tls_context_set_ticket_lifetime\fP (\fBuvhttp_tls_context_t\fP *ctx, int lifetime_seconds)"
.br
.ti -1c
.RI "\fBuvhttp_tls_error_t\fP \fBuvhttp_tls_verify_cert_chain\fP (mbedtls_ssl_context *ssl)"
.br
.ti -1c
.RI "\fBuvhttp_tls_error_t\fP \fBuvhttp_tls_context_add_extra_chain_cert\fP (\fBuvhttp_tls_context_t\fP *ctx, const char *cert_file)"
.br
.ti -1c
.RI "\fBuvhttp_tls_error_t\fP \fBuvhttp_tls_get_cert_chain\fP (mbedtls_ssl_context *ssl, mbedtls_x509_crt **chain)"
.br
.ti -1c
.RI "\fBuvhttp_tls_error_t\fP \fBuvhttp_tls_get_stats\fP (\fBuvhttp_tls_context_t\fP *ctx, \fBuvhttp_tls_stats_t\fP *stats)"
.br
.ti -1c
.RI "\fBuvhttp_tls_error_t\fP \fBuvhttp_tls_reset_stats\fP (\fBuvhttp_tls_context_t\fP *ctx)"
.br
.ti -1c
.RI "\fBuvhttp_tls_error_t\fP \fBuvhttp_tls_get_connection_info\fP (mbedtls_ssl_context *ssl, char *buf, size_t buf_size)"
.br
.ti -1c
.RI "void \fBuvhttp_tls_get_error_string\fP (int ret, char *buf, size_t buf_size)"
.br
.ti -1c
.RI "void \fBuvhttp_tls_print_error\fP (int ret)"
.br
.in -1c
.SH "Typedef Documentation"
.PP 
.SS "typedef struct \fBuvhttp_context\fP \fBuvhttp_context_t\fP"

.SS "typedef struct \fBuvhttp_tls_context\fP \fBuvhttp_tls_context_t\fP"

.SS "typedef struct \fBuvhttp_tls_stats\fP \fBuvhttp_tls_stats_t\fP"

.SH "Enumeration Type Documentation"
.PP 
.SS "enum \fBuvhttp_tls_error_t\fP"

.PP
\fBEnumerator\fP
.in +1c
.TP
\fB\fIUVHTTP_TLS_OK \fP\fP
.TP
\fB\fIUVHTTP_TLS_ERROR_INIT \fP\fP
.TP
\fB\fIUVHTTP_TLS_ERROR_CERT \fP\fP
.TP
\fB\fIUVHTTP_TLS_ERROR_KEY \fP\fP
.TP
\fB\fIUVHTTP_TLS_ERROR_CA \fP\fP
.TP
\fB\fIUVHTTP_TLS_ERROR_VERIFY \fP\fP
.TP
\fB\fIUVHTTP_TLS_ERROR_HANDSHAKE \fP\fP
.TP
\fB\fIUVHTTP_TLS_ERROR_READ \fP\fP
.TP
\fB\fIUVHTTP_TLS_ERROR_WRITE \fP\fP
.TP
\fB\fIUVHTTP_TLS_ERROR_INVALID_PARAM \fP\fP
.TP
\fB\fIUVHTTP_TLS_ERROR_MEMORY \fP\fP
.TP
\fB\fIUVHTTP_TLS_ERROR_NOT_IMPLEMENTED \fP\fP
.TP
\fB\fIUVHTTP_TLS_ERROR_PARSE \fP\fP
.TP
\fB\fIUVHTTP_TLS_ERROR_NO_CERT \fP\fP
.TP
\fB\fIUVHTTP_TLS_ERROR_WANT_READ \fP\fP
.TP
\fB\fIUVHTTP_TLS_ERROR_WANT_WRITE \fP\fP
.SH "Function Documentation"
.PP 
.SS "int uvhttp_tls_check_cert_validity (mbedtls_x509_crt * cert)"

.SS "void uvhttp_tls_cleanup (\fBuvhttp_context_t\fP * context)"

.SS "\fBuvhttp_tls_error_t\fP uvhttp_tls_context_add_extra_chain_cert (\fBuvhttp_tls_context_t\fP * ctx, const char * cert_file)"

.SS "\fBuvhttp_tls_error_t\fP uvhttp_tls_context_enable_client_auth (\fBuvhttp_tls_context_t\fP * ctx, int require_cert)"

.SS "\fBuvhttp_tls_error_t\fP uvhttp_tls_context_enable_crl_checking (\fBuvhttp_tls_context_t\fP * ctx, int enable)"

.SS "\fBuvhttp_tls_error_t\fP uvhttp_tls_context_enable_early_data (\fBuvhttp_tls_context_t\fP * ctx, int enable)"

.SS "\fBuvhttp_tls_error_t\fP uvhttp_tls_context_enable_ocsp_stapling (\fBuvhttp_tls_context_t\fP * ctx, int enable)"

.SS "\fBuvhttp_tls_error_t\fP uvhttp_tls_context_enable_session_tickets (\fBuvhttp_tls_context_t\fP * ctx, int enable)"

.SS "\fBuvhttp_tls_error_t\fP uvhttp_tls_context_enable_tls13 (\fBuvhttp_tls_context_t\fP * ctx, int enable)"

.SS "void uvhttp_tls_context_free (\fBuvhttp_tls_context_t\fP * ctx)"

.SS "\fBuvhttp_tls_error_t\fP uvhttp_tls_context_load_ca_file (\fBuvhttp_tls_context_t\fP * ctx, const char * ca_file)"

.SS "\fBuvhttp_tls_error_t\fP uvhttp_tls_context_load_cert_chain (\fBuvhttp_tls_context_t\fP * ctx, const char * cert_file)"

.SS "\fBuvhttp_tls_error_t\fP uvhttp_tls_context_load_private_key (\fBuvhttp_tls_context_t\fP * ctx, const char * key_file)"

.SS "\fBuvhttp_tls_context_t\fP* uvhttp_tls_context_new (void)"

.SS "\fBuvhttp_tls_error_t\fP uvhttp_tls_context_rotate_ticket_key (\fBuvhttp_tls_context_t\fP * ctx)"

.SS "\fBuvhttp_tls_error_t\fP uvhttp_tls_context_set_cipher_suites (\fBuvhttp_tls_context_t\fP * ctx, const int * cipher_suites)"

.SS "\fBuvhttp_tls_error_t\fP uvhttp_tls_context_set_dh_parameters (\fBuvhttp_tls_context_t\fP * ctx, const char * dh_file)"

.SS "\fBuvhttp_tls_error_t\fP uvhttp_tls_context_set_session_cache (\fBuvhttp_tls_context_t\fP * ctx, int max_sessions)"

.SS "\fBuvhttp_tls_error_t\fP uvhttp_tls_context_set_ticket_key (\fBuvhttp_tls_context_t\fP * ctx, const unsigned char * key, size_t key_len)"

.SS "\fBuvhttp_tls_error_t\fP uvhttp_tls_context_set_ticket_lifetime (\fBuvhttp_tls_context_t\fP * ctx, int lifetime_seconds)"

.SS "\fBuvhttp_tls_error_t\fP uvhttp_tls_context_set_tls13_cipher_suites (\fBuvhttp_tls_context_t\fP * ctx, const char * cipher_suites)"

.SS "\fBuvhttp_tls_error_t\fP uvhttp_tls_context_set_verify_depth (\fBuvhttp_tls_context_t\fP * ctx, int depth)"

.SS "mbedtls_ssl_context* uvhttp_tls_create_ssl (\fBuvhttp_tls_context_t\fP * ctx)"

.SS "\fBuvhttp_tls_error_t\fP uvhttp_tls_get_cert_chain (mbedtls_ssl_context * ssl, mbedtls_x509_crt ** chain)"

.SS "int uvhttp_tls_get_cert_issuer (mbedtls_x509_crt * cert, char * buf, size_t buf_size)"

.SS "int uvhttp_tls_get_cert_serial (mbedtls_x509_crt * cert, char * buf, size_t buf_size)"

.SS "int uvhttp_tls_get_cert_subject (mbedtls_x509_crt * cert, char * buf, size_t buf_size)"

.SS "\fBuvhttp_tls_error_t\fP uvhttp_tls_get_connection_info (mbedtls_ssl_context * ssl, char * buf, size_t buf_size)"

.SS "void uvhttp_tls_get_error_string (int ret, char * buf, size_t buf_size)"

.SS "\fBuvhttp_tls_error_t\fP uvhttp_tls_get_ocsp_response (mbedtls_ssl_context * ssl, unsigned char ** ocsp_response, size_t * response_len)"

.SS "mbedtls_x509_crt* uvhttp_tls_get_peer_cert (mbedtls_ssl_context * ssl)"

.SS "\fBuvhttp_tls_error_t\fP uvhttp_tls_get_stats (\fBuvhttp_tls_context_t\fP * ctx, \fBuvhttp_tls_stats_t\fP * stats)"

.SS "\fBuvhttp_tls_error_t\fP uvhttp_tls_handshake (mbedtls_ssl_context * ssl)"

.SS "\fBuvhttp_tls_error_t\fP uvhttp_tls_init (\fBuvhttp_context_t\fP * context)"

.SS "\fBuvhttp_tls_error_t\fP uvhttp_tls_load_crl_file (\fBuvhttp_tls_context_t\fP * ctx, const char * crl_file)"

.SS "void uvhttp_tls_print_error (int ret)"

.SS "\fBuvhttp_tls_error_t\fP uvhttp_tls_read (mbedtls_ssl_context * ssl, void * buf, size_t len)"

.SS "\fBuvhttp_tls_error_t\fP uvhttp_tls_reset_stats (\fBuvhttp_tls_context_t\fP * ctx)"

.SS "\fBuvhttp_tls_error_t\fP uvhttp_tls_setup_ssl (mbedtls_ssl_context * ssl, int fd)"

.SS "\fBuvhttp_tls_error_t\fP uvhttp_tls_verify_cert_chain (mbedtls_ssl_context * ssl)"

.SS "int uvhttp_tls_verify_hostname (mbedtls_x509_crt * cert, const char * hostname)"

.SS "\fBuvhttp_tls_error_t\fP uvhttp_tls_verify_ocsp_response (mbedtls_x509_crt * cert, const unsigned char * ocsp_response, size_t response_len)"

.SS "int uvhttp_tls_verify_peer_cert (mbedtls_ssl_context * ssl)"

.SS "\fBuvhttp_tls_error_t\fP uvhttp_tls_write (mbedtls_ssl_context * ssl, const void * buf, size_t len)"

.SH "Author"
.PP 
Generated automatically by Doxygen for UVHTTP from the source code\&.
